/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();define(["require","exports","wijmo/wijmo.grid","wijmo/wijmo.xlsx","wijmo/wijmo","wijmo/wijmo.grid.xlsx"],function(n,t,i,r,u,f){"use strict";function s(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.detail}function h(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.multirow}var e,o;Object.defineProperty(t,"__esModule",{value:!0});window.wijmo=window.wijmo||{};window.wijmo.grid=window.wijmo.grid||{};window.wijmo.grid.xlsx=f;e=function(){function n(){}return n.save=function(n,t,i){var r=this._saveFlexGridToWorkbook(n,t);return i&&r.save(i),r},n.saveAsync=function(n,t,i,r,u){var f=this._saveFlexGridToWorkbook(n,t);return f.saveAsync(i,r,u),f},n.load=function(n,t,i){var o=this,f,e;if(t instanceof Blob)f=new FileReader,f.onload=function(){var u=r.Workbook._base64EncArr(new Uint8Array(f.result)),t=new r.Workbook;t.load(u);u=null;n.deferUpdate(function(){o._loadToFlexGrid(n,t,i);t=null})},f.readAsArrayBuffer(t);else if(t instanceof r.Workbook)n.deferUpdate(function(){o._loadToFlexGrid(n,t,i);t=null});else{if(t instanceof ArrayBuffer)t=r.Workbook._base64EncArr(new Uint8Array(t));else if(!u.isString(t))throw'Invalid workbook.';e=new r.Workbook;e.load(t);t=null;n.deferUpdate(function(){o._loadToFlexGrid(n,e,i);e=null})}},n.loadAsync=function(n,t,i,f,e){var s=this,o,h;if(t instanceof Blob)o=new FileReader,o.onload=function(){var t=r.Workbook._base64EncArr(new Uint8Array(o.result)),u=new r.Workbook;u.loadAsync(t,function(r){t=null;u=null;n.deferUpdate(function(){s._loadToFlexGrid(n,r,i);f&&f(r);r=null})},e)},o.readAsArrayBuffer(t);else if(t instanceof r.Workbook)n.deferUpdate(function(){s._loadToFlexGrid(n,t,i);f&&f(t);t=null});else{if(t instanceof ArrayBuffer)t=r.Workbook._base64EncArr(new Uint8Array(t));else if(!u.isString(t))throw'Invalid workbook.';h=new r.Workbook;h.loadAsync(t,function(r){t=null;n.deferUpdate(function(){s._loadToFlexGrid(n,r,i);f&&f(r);r=null})},e)}},n._saveFlexGridToWorkbook=function(n,t){var ut=new r.Workbook,l=new r.WorkSheet,ot=new r.WorkbookStyle,ft=new r.WorkbookFrozenPane,st=t&&t.includeColumnHeaders!=null?t.includeColumnHeaders:!0,tt=t&&t.includeRowHeaders!=null?t.includeRowHeaders:!1,b=t&&t.includeCellStyles!=null?t.includeCellStyles:!0,at=t?t.activeWorksheet:null,v=t?t.includeColumns:null,k=t?t.formatItem:null,o,y,d,p,w,s,ht,f,h,e,et,a,nt,ct,g,it=0,rt=0,lt=0,c=0;if(et=n.wj_sheetInfo,l.name=t?t.sheetName:'',l.visible=t?t.sheetVisible!==!1:!0,ht={borders:{top:{style:r.BorderStyle.Thin,color:'#C6C6C6'},left:{style:r.BorderStyle.Thin,color:'#C6C6C6'},bottom:{style:r.BorderStyle.Thin,color:'#C6C6C6'},right:{style:r.BorderStyle.Thin,color:'#C6C6C6'}}},ot._deserialize(ht),l.style=ot,s=[],!et&&(b||k)&&(a=document.createElement('div'),a.style.visibility='hidden',a.setAttribute(i.FlexGrid._WJS_MEASURE,'true'),n.hostElement.appendChild(a)),tt){for(h=0,f=0;f<n.rowHeaders.rows.length;f++)if(!(n.rowHeaders.rows[f].renderSize<=0)){for(s[h]=[],e=0;e<n.rowHeaders.columns.length;e++)d=n._getBindingColumn(n.rowHeaders,f,n.rowHeaders.columns[e]),p=this._getColumnSetting(d,n.columnHeaders.columns.defaultSize),s[h][e]=p,h===0&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w,e));h++}c=e}if(st&&n.columnHeaders.rows.length>0){for(h=0,f=0;f<n.columnHeaders.rows.length;f++)if(!(n.columnHeaders.rows[f].renderSize<=0)){for(s[h]||(s[h]=[]),e=0;e<n.columnHeaders.columns.length;e++)d=n._getBindingColumn(n.columnHeaders,f,n.columnHeaders.columns[e]),p=this._getColumnSetting(d,n.columnHeaders.columns.defaultSize),s[h][c+e]=p,h===0&&(!v||v(d))&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w));c=0;o={};y=new r.WorkbookRow;tt&&(c=this._parseFlexGridRowToSheetRow(n.topLeftCells,o,f,0,s,b,a,!1,0,v,k));this._parseFlexGridRowToSheetRow(n.columnHeaders,o,f,c,s,b,a,!1,0,v,k);o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,h));h++}rt=h}else for(s[0]||(s[0]=[]),e=0;e<n.columnHeaders.columns.length;e++)d=n._getBindingColumn(n.columnHeaders,0,n.columnHeaders.columns[e]),p=this._getColumnSetting(d,n.columnHeaders.columns.defaultSize),s[0][c+e]=p,(!v||v(d))&&(w=new r.WorkbookColumn,w._deserialize(p),l._addWorkbookColumn(w));for(f=0;f<n.cells.rows.length;f++)(c=0,o={},y=new r.WorkbookRow,nt=n.rows[f],nt instanceof i._NewRowTemplate)||(g=nt instanceof i.GroupRow,g?(ct=u.tryCast(nt,i.GroupRow),it=ct.level):n.rows.maxGroupLevel>-1&&(it=n.rows.maxGroupLevel+1),tt&&(c=this._parseFlexGridRowToSheetRow(n.rowHeaders,o,f,0,s,b,a,g,it,v,k)),this._parseFlexGridRowToSheetRow(n.cells,o,f,c,s,b,a,g,it,v,k),o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,rt+f)));for(lt=n.cells.rows.length,f=0;f<n.columnFooters.rows.length;f++)c=0,o={},y=new r.WorkbookRow,nt=n.columnFooters.rows[f],g=nt instanceof i.GroupRow,tt&&(c=this._parseFlexGridRowToSheetRow(n.rowHeaders,o,f,0,s,b,a,g,0,v,k)),this._parseFlexGridRowToSheetRow(n.columnFooters,o,f,c,s,b,a,g,0,v,k),o.cells.length>0&&(y._deserialize(o),l._addWorkbookRow(y,rt+lt+f));return ft.rows=st?n.frozenRows+rt:n.frozenRows,ft.columns=tt?n.frozenColumns+c:n.frozenColumns,l.frozenPane=ft,ut._addWorkSheet(l),!et&&(b||k)&&n.hostElement.removeChild(a),ut.activeWorksheet=at,ut},n._loadToFlexGrid=function(n,t,f){var fi=f&&f.includeColumnHeaders!=null?f.includeColumnHeaders:!0,b=f&&f.includeColumnHeaders!=null?f.includeColumnHeaders:!0,wt=f&&f.sheetIndex!=null&&!isNaN(f.sheetIndex)?f.sheetIndex:0,gt=f?f.sheetName:null,ei=f?f.sheetVisible:!0,ni=n.wj_sheetInfo!=null,o=0,h=0,w,ft,p,et,d,k,ot,bt,it,ti,s,l,ii,nt,st,c,ht,ct,ri,kt,v,lt,tt,g,a,e,y,dt,at,vt,ui,rt,yt=!1,pt={},ut;if(n.itemsSource=null,n.columns.clear(),n.rows.clear(),n.frozenColumns=0,n.frozenRows=0,y={},dt={},h=0,et=[],at=[],wt<0||wt>=t.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(gt!=null)for(w=0;w<t.sheets.length;w++)if(gt===t.sheets[w].name){l=t.sheets[w];break}if(l=l||t.sheets[wt],l.rows!=null){for(fi&&(h=1,l.rows.length<=1&&(b=!1,h=0),bt=l.rows[0]),nt=this._getColumnCount(l.rows),ii=this._getRowCount(l.rows,nt),ri=l.summaryBelow,p=l.columns,o=0;o<nt;o++)n.columns.push(new i.Column),!p[o]||(isNaN(+p[o].width)||(n.columns[o].width=+p[o].width),p[o].visible||p[o].visible==undefined||(n.columns[o].visible=!!p[o].visible),p[o].style&&!!p[o].style.wordWrap&&(n.columns[o].wordWrap=p[o].style.wordWrap));for(;h<ii;h++){if(st=!1,ut=null,s=l.rows[h],s)for(ht=h+1;ht<l.rows.length;)if(ct=l.rows[ht],ct){(isNaN(s.groupLevel)&&!isNaN(ct.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<ct.groupLevel)&&(st=!0);break}else ht++;for(st&&!ri?(v&&(v.isCollapsed=yt),v=new i.GroupRow,v.isReadOnly=!1,yt=s.collapsed==null?!1:s.collapsed,v.level=isNaN(s.groupLevel)?0:s.groupLevel,pt[v.level]=yt,this._checkParentCollapsed(pt,v.level)&&v._setFlag(i.RowColFlags.ParentCollapsed,!0),n.rows.push(v)):(kt=new i.Row,s&&this._checkParentCollapsed(pt,s.groupLevel)&&kt._setFlag(i.RowColFlags.ParentCollapsed,!0),n.rows.push(kt)),!s||!s.height||isNaN(s.height)||(n.rows[b?h-1:h].height=s.height),o=0;o<nt;o++)if(s){if(c=s.cells[o],g=c?c.formula:undefined,g&&g[0]!=='='&&(g='='+g),n.setCellData(b?h-1:h,o,g&&ni?g:this._getItemValue(c)),st||this._setColumn(et,o,c),a=h*nt+o,e=c?c.style:undefined,vt=r.Workbook._parseExcelFormat(c),e){if(ut=ut==null?!!e.wordWrap:ut&&!!e.wordWrap,ui=this._getItemType(c),e.hAlign)rt=r.Workbook._parseHAlignToString(u.asEnum(e.hAlign,r.HAlign));else switch(ui){case u.DataType.Number:rt='right';break;case u.DataType.Boolean:rt='center';break;default:rt=vt&&vt.search(/[n,c,p]/i)===0?'right':'left'}y[a]={fontWeight:e.font&&e.font.bold?'bold':'none',fontStyle:e.font&&e.font.italic?'italic':'none',textDecoration:e.font&&e.font.underline?'underline':'none',textAlign:rt,fontFamily:e.font&&e.font.family?e.font.family:'',fontSize:e.font&&e.font.size?e.font.size+'px':'',color:e.font&&e.font.color?e.font.color:'',backgroundColor:e.fill&&e.fill.color?e.fill.color:'',whiteSpace:e.wordWrap?'pre-wrap':'normal',format:vt};e.borders&&(e.borders.left&&(this._parseBorderStyle(e.borders.left.style,'Left',y[a]),y[a].borderLeftColor=e.borders.left.color),e.borders.right&&(this._parseBorderStyle(e.borders.right.style,'Right',y[a]),y[a].borderRightColor=e.borders.right.color),e.borders.top&&(this._parseBorderStyle(e.borders.top.style,'Top',y[a]),y[a].borderTopColor=e.borders.top.color),e.borders.bottom&&(this._parseBorderStyle(e.borders.bottom.style,'Bottom',y[a]),y[a].borderBottomColor=e.borders.bottom.color));e.font&&at.indexOf(e.font.family)===-1&&at.push(e.font.family)}if(c&&u.isNumber(c.rowSpan)&&c.rowSpan>0&&u.isNumber(c.colSpan)&&c.colSpan>0&&(c.rowSpan>1||c.colSpan>1))for(w=h;w<h+c.rowSpan;w++)for(ft=o;ft<o+c.colSpan;ft++)a=w*nt+ft,dt[a]=new i.CellRange(h,o,h+c.rowSpan-1,o+c.colSpan-1)}else n.setCellData(b?h-1:h,o,''),this._setColumn(et,o,undefined);s&&(this._checkParentCollapsed(pt,s.groupLevel)||s.visible||s.visible==undefined||(n.rows[b?h-1:h].visible=s.visible),n.rows[b?h-1:h].wordWrap=!!s.style&&!!s.style.wordWrap||!!ut)}for(v&&(v.isCollapsed=yt),l.frozenPane&&(lt=l.frozenPane.columns,u.isNumber(lt)&&!isNaN(lt)&&(n.frozenColumns=lt),tt=l.frozenPane.rows,u.isNumber(tt)&&!isNaN(tt)&&(n.frozenRows=b&&tt>0?tt-1:tt)),o=0;o<n.columnHeaders.columns.length;o++)d=et[o],k=n.columns[o],k.isRequired=!1,b?(it=bt?bt.cells[o]:undefined,it&&it.value?(ti=r.Workbook._parseExcelFormat(it),ot=u.Globalize.format(it.value,ti)):ot=this._numAlpha(o)):ot=this._numAlpha(o),k.header=ot,d&&(d.dataType===u.DataType.Boolean&&(k.dataType=d.dataType),k.format=d.format,k.align=d.hAlign,k.wordWrap=k.wordWrap||!!d.wordWrap);ni&&(n.wj_sheetInfo.name=l.name,n.wj_sheetInfo.visible=ei===!0?!0:l.visible!==!1,n.wj_sheetInfo.styledCells=y,n.wj_sheetInfo.mergedRanges=dt,n.wj_sheetInfo.fonts=at)}},n._parseFlexGridRowToSheetRow=function(n,t,f,e,c,l,a,v,y,p,w){var d,nt,et,b,st,g,k,rt,ft,lt,vt,gt,ot,tt,yt,wt,at,it,ti=!1,bt,ht,ii,kt,ni,ut,ct,dt,pt;for(d=n.grid,at=d.wj_sheetInfo,nt=n.rows[f],ii=nt.recordIndex!=null?nt.recordIndex:0,t.cells||(t.cells=[]),t.visible=nt.isVisible,t.height=nt.renderHeight||n.rows.defaultSize,t.groupLevel=y,v&&(t.collapsed=nt.isCollapsed),nt.wordWrap&&(t.style={wordWrap:nt.wordWrap}),(nt.constructor===i.Row||nt.constructor===i._NewRowTemplate||s()&&nt.constructor===s().DetailRow||h()&&nt.constructor===h()._MultiRow)&&(ti=!0),b=0;b<n.columns.length;b++)if(st=null,wt=1,yt=1,pt=0,ht=!1,ot=null,ct=null,bt=d._getBindingColumn(n,f,n.columns[b]),tt=null,at&&n===d.cells?(gt=f*n.columns.length+b,at.mergedRanges&&(tt=at.mergedRanges[gt]),at.styledCells&&(ot=at.styledCells[gt])):l&&(ut=a.cloneNode(),n.hostElement.children.length>0?n.hostElement.children[0].appendChild(ut):n.hostElement.appendChild(ut),tt=d.getMergedRange(n,f,b,!1),ot=tt?this._getCellStyle(n,ut,tt.bottomRow,tt.rightCol)||{}:this._getCellStyle(n,ut,f,b)||{}),tt||(tt=d.getMergedRange(n,f,b,!1)),tt?f===tt.topRow&&b===tt.leftCol&&(yt=tt.bottomRow-tt.topRow+1,wt=this._getColSpan(n,tt,p),ht=!0):ht=!0,!p||p(bt)){if(et=c[ii][b+e],ti||v?(k=ht?n.getCellData(f,b,!0):null,rt=ht?n.getCellData(f,b,!1):null,lt=!1,k&&u.isString(k)&&k.length>1&&k[0]==='='&&(lt=!0),it=u.isDate(rt),ot&&ot.format?(st=ot.format,g=r.Workbook._parseCellFormat(ot.format,it)):et&&et.style&&et.style.format?(st=bt.format,g=et.style.format):g=null,g||(it?g='m/d/yyyy':u.isNumber(rt)&&!bt.dataMap?g=u.isInt(rt)?'#,##0':'#,##0.00':lt?(vt=k.toLowerCase(),vt.indexOf('now()')>-1?(g='m/d/yyyy h:mm',it=!0):vt.indexOf('today()')>-1||vt.indexOf('date(')>-1?(g='m/d/yyyy',it=!0):vt.indexOf('time(')>-1&&(g='h:mm AM/PM',it=!0)):g='General')):(k=ht?d.columnHeaders.getCellData(0,b,!0):null,g='General'),ct=this._parseCellStyle(ot)||{},n===d.cells&&v&&nt.hasChildren&&b===d.columns.firstVisibleIndex){if(k?ft=k:ht&&(ft=nt.getGroupHeader().replace(/<\/?\w+>/g,'')),ft==null&&!ot)continue;it=u.isDate(ft);!it&&st&&st.toLowerCase()==='d'&&u.isInt(ft)&&(g='0');ft=typeof ft=='string'?r.Workbook._unescapeXML(ft):ft;b===d.columns.firstVisibleIndex&&d.treeIndent&&(pt=y);kt={value:ft,isDate:it,formula:lt?this._parseToExcelFormula(k,it):null,colSpan:wt,rowSpan:yt,style:this._extend(ct,{format:g,font:{bold:!0},hAlign:r.HAlign.Left,indent:pt})}}else k=typeof k=='string'?r.Workbook._unescapeXML(k):k,rt=typeof rt=='string'?r.Workbook._unescapeXML(rt):rt,!it&&st&&st.toLowerCase()==='d'&&u.isInt(rt)&&(g='0'),dt=ct&&ct.hAlign?ct.hAlign:et&&et.style&&et.style.hAlign!=null?u.asEnum(et.style.hAlign,r.HAlign,!0):u.isDate(rt)?r.HAlign.Left:r.HAlign.General,b===d.columns.firstVisibleIndex&&d.treeIndent&&(dt===r.HAlign.Left||dt===r.HAlign.General)&&(pt=y),kt={value:lt?null:g==='General'?u.isString(k)?k.replace(/^(\')(\s*=)/,'$2'):k:rt,isDate:it,formula:lt?this._parseToExcelFormula(k,it):null,colSpan:b<d.columns.firstVisibleIndex?1:wt,rowSpan:yt,style:this._extend(ct,{format:g,hAlign:dt,vAlign:yt>1?n===d.cells||d.centerHeadersVertically===!1?r.VAlign.Top:r.VAlign.Center:null,indent:pt})};w&&(ni=new o(n,new i.CellRange(f,b),ut,a,kt),w(ni),ut=ni.cell);ut&&(ut.parentElement.removeChild(ut),ut=null);t.cells.push(kt)}return e+b},n._parseCellStyle=function(n){var t,u,e,i,f;return n==null?null:(t=n.fontSize,t=t?+t.substring(0,t.indexOf('px')):null,isNaN(t)&&(t=null),u=n.fontWeight,u=u==='bold'||+u>=700,e=n.fontStyle==='italic',i=n.textDecorationStyle,i==null&&(i=n.textDecoration),i=i==='underline',f=n.whiteSpace,f=f?f.indexOf('pre')>-1?!0:!1:!1,{font:{bold:u,italic:e,underline:i,family:this._parseToExcelFontFamily(n.fontFamily),size:t,color:n.color},fill:{color:n.backgroundColor},borders:this._parseBorder(n),hAlign:r.Workbook._parseStringToHAlign(n.textAlign),wordWrap:f})},n._parseBorder=function(n){var t={};return t.left=this._parseEgdeBorder(n,'Left'),t.right=this._parseEgdeBorder(n,'Right'),t.top=this._parseEgdeBorder(n,'Top'),t.bottom=this._parseEgdeBorder(n,'Bottom'),t},n._parseEgdeBorder=function(n,t){var u,f=n['border'+t+'Style'],i;if(f&&f!=='none'&&f!=='hidden'){u={};f=f.toLowerCase();switch(f){case'dotted':u.style=r.BorderStyle.Dotted;break;case'dashed':u.style=r.BorderStyle.Dashed;break;case'double':u.style=r.BorderStyle.Double;break;default:i=n['border'+t+'Width'];i&&i.length>2&&(i=+i.substring(0,i.length-2));u.style=i>2?r.BorderStyle.Thick:i>1?r.BorderStyle.Medium:r.BorderStyle.Thin}u.color=n['border'+t+'Color']}return u},n._parseBorderStyle=function(n,t,i){var u='border'+t+'Style',f='border'+t+'Width';switch(n){case r.BorderStyle.Dotted:case r.BorderStyle.Hair:i[u]='dotted';i[f]='1px';break;case r.BorderStyle.Dashed:case r.BorderStyle.ThinDashDotDotted:case r.BorderStyle.ThinDashDotted:i[u]='dashed';i[f]='1px';break;case r.BorderStyle.MediumDashed:case r.BorderStyle.MediumDashDotDotted:case r.BorderStyle.MediumDashDotted:case r.BorderStyle.SlantedMediumDashDotted:i[u]='dashed';i[f]='2px';break;case r.BorderStyle.Double:i[u]='double';i[f]='3px';break;case r.BorderStyle.Medium:i[u]='solid';i[f]='2px';break;default:i[u]='solid';i[f]='1px'}},n._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},n._parseToExcelFormula=function(n,t){var i,e,o,h,u,f,s;if(i=n.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi),i)for(u=0;u<i.length;u++)f=i[u],s=f.substring(0,f.lastIndexOf(')'))+', 1)',n=n.replace(f,s);if(i=null,i=n.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi),i)for(u=0;u<i.length;u++)f=i[u],e=f.match(/\"?\w+\"?\s*\,\s*\"(\w+)\"/i),e&&e.length===2&&(o=e[1],/^d{1,4}?$/.test(o)||(h=r.Workbook._parseCellFormat(o,t),s=f.replace(o,h),n=n.replace(f,s)));return n},n._getColumnSetting=function(n,t){var i=n.renderWidth;return i=i||t,{autoWidth:!0,width:i,visible:n.visible,style:{format:n.format?r.Workbook._parseCellFormat(n.format,n.dataType===u.DataType.Date):'',hAlign:r.Workbook._parseStringToHAlign(this._toExcelHAlign(n.getAlignment())),wordWrap:n.wordWrap}}},n._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},n._getColumnCount=function(n){for(var f=0,t=0,i,r=0;r<n.length;r++)i=n[r]&&n[r].cells?n[r].cells:[],i&&i.length>0&&(t=i.length,u.isInt(i[t-1].colSpan)&&i[t-1].colSpan>1&&(t=t+i[t-1].colSpan-1),t>f&&(f=t));return f},n._getRowCount=function(n,t){for(var f=n.length,r=f-1,o=0,e,s,i;o<t;o++)n:for(;r>=0;r--)if(e=n[r],s=e&&e.cells?e.cells:[],i=s[o],i&&(i.value!=null&&i.value!==''||u.isInt(i.rowSpan)&&i.rowSpan>1)){u.isInt(i.rowSpan)&&i.rowSpan>1&&r+i.rowSpan>f&&(f=r+i.rowSpan);break n}return f},n._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},n._getItemType=function(n){return n===undefined||n===null||n.value===undefined||n.value===null||isNaN(n.value)?undefined:u.getType(n.value)},n._setColumn=function(n,t,i){var e,o,s,f=n[t];f?(e=this._getItemType(i),f.dataType!==e&&f.dataType===u.DataType.Boolean&&e!==u.DataType.Boolean&&(f.dataType=e),i&&i.value!=null&&i.value!==''&&(o=r.Workbook._parseExcelFormat(i),o&&f.format!==o&&o!=='General'&&(f.format=o)),i&&i.style&&(i.style.hAlign&&(s=r.Workbook._parseHAlignToString(u.asEnum(i.style.hAlign,r.HAlign))),f.wordWrap=f.wordWrap==null?!!i.style.wordWrap:f.wordWrap&&!!i.style.wordWrap),s||e!==u.DataType.Number||(s='right'),f.hAlign=s):n[t]={dataType:this._getItemType(i),format:r.Workbook._parseExcelFormat(i),hAlign:'',wordWrap:null}},n._getItemValue=function(n){if(n===undefined||n===null||n.value===undefined||n.value===null)return undefined;var t=n.value;return u.isNumber(t)&&isNaN(t)?'':t instanceof Date&&isNaN(t.getTime())?'':t},n._getCellStyle=function(n,t,i,r){try{n.grid.cellFactory.updateCell(n,i,r,t);t.className=t.className.replace('wj-state-selected','');t.className=t.className.replace('wj-state-multi-selected','')}catch(u){return null}return window.getComputedStyle(t)},n._extend=function(n,t){var i,r;for(i in t)r=t[i],u.isObject(r)&&n[i]?u.copy(n[i],r):n[i]=r;return n},n._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},n._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},n}();t.FlexGridXlsxConverter=e;o=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e._cell=r,e._patternCell=u,e._xlsxCell=f,e}return __extends(t,n),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(n){this._xlsxCell=n},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this.panel.hostElement.children[0].appendChild(this._cell),e._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},t}(i.CellRangeEventArgs);t.XlsxFormatItemEventArgs=o})