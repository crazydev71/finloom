/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
define(["require","exports","wijmo/wijmo","@angular/core"],function(n,t,i,r){"use strict";function c(n){return new h(n)}var e,s,u,f,h,l,o;Object.defineProperty(t,"__esModule",{value:!0});e=function(){function n(){}return n}();e.asyncBindings=!0;t.WjOptions=e;s=function(){function n(n){this.changeEventMap=[];this.allImplEvents=[];this.resolveChangeEventMap(n)}return n.prototype.resolveChangeEventMap=function(n){var r=this.changeEventMap,s=n.outputs,h=n.changeEvents||{},c,a,u,l,t,v,e,o,i;if(r.splice(0,r.length),this.allImplEvents=[],s&&s.length){for(c=s.map(function(n){return n.split(':')}).map(function(n){return{implName:n[0].trim(),exposeName:n[1]&&n[1].trim()}}),this.allImplEvents=c.map(function(n){return n.implName}),a=c.filter(function(n){return n.implName&&n.exposeName}),u=0,l=a;u<l.length;u++)t=l[u],v=f.getWjEventName(t.implName),v&&(i={eventImpl:t.implName,event:t.exposeName},e=h[t.exposeName],e&&e.length&&(i.props=e.map(function(n){return{prop:n,evExposed:f.getChangeEventNameExposed(n),evImpl:f.getChangeEventNameImplemented(n)}})),r.push(i));for(o in h)o.indexOf('.')>-1&&(i={eventImpl:null,event:o,props:h[o].map(function(n){return{prop:n,evExposed:f.getChangeEventNameExposed(n),evImpl:f.getChangeEventNameImplemented(n)}})},r.push(i))}},n}();t.WjComponentResolvedMetadata=s;u=function(){function n(t,i,r,u){var f,e;this._pendingEvents=[];this.isInitialized=!1;this.isDestroyed=!1;this.directive=t;this.elementRef=i;this.injector=r;this.injectedParent=u;f=this.typeData=t.constructor[n.directiveTypeDataProp];f.siblingId==null&&(f.siblingId=++n.siblingDirId+'');e=t.constructor[n.directiveResolvedTypeDataProp];e?this.resolvedTypeData=e:t.constructor[n.directiveResolvedTypeDataProp]=e=this.resolvedTypeData=new s(f);t[n.BehaviourRefProp]=this;r[n.BehaviourRefProp]=this;t[n.isInitializedPropAttr]=!1;this._createEvents();this._setupAsChild();this._isHostElement()&&i.nativeElement.setAttribute(n.siblingDirIdAttr,f.siblingId);this.subscribeToEvents(!1)}return n.getHostElement=function(t,i){return n.ngZone||(n.ngZone=i.get(r.NgZone)),t.nativeElement},n.attach=function(t,i,r,u){return new n(t,i,r,u)},n.prototype.ngOnInit=function(){this.isInitialized=!0;this._initParent();this.subscribeToEvents(!0)},n.prototype.ngAfterViewInit=function(){this.directive[n.isInitializedPropAttr]=!0;this.directive[n.initializedEventAttr].emit(undefined)},n.prototype.ngOnDestroy=function(){var t,e,o,f,s;if(!this.isDestroyed){if(this.isDestroyed=!0,t=this.directive,this._siblingInsertedEH&&this.elementRef.nativeElement.removeEventListener('DOMNodeInserted',this._siblingInsertedEH),this._isChild()&&this.parentBehavior&&(e=this.parentBehavior.directive,o=this._getParentProp(),!this.parentBehavior.isDestroyed&&e&&o&&t&&(f=e[o],i.isArray(f)&&f&&(s=f.indexOf(t),s>=0&&f.splice(s,1)))),t instanceof i.Control&&t.hostElement){var r=this.elementRef.nativeElement,u=r&&r.parentNode,h=u?Array.prototype.indexOf.call(u.childNodes,r):-1;t.dispose();h>-1&&Array.prototype.indexOf.call(u.childNodes,r)<0&&(r.textContent='',h<u.childNodes.length&&u.replaceChild(r,u.childNodes[h]))}this.injector[n.BehaviourRefProp]=null}},n.instantiateTemplate=function(n,t,i,r,u){var s,e,f,o,h,c;if(u===void 0&&(u=!1),s=t.createEmbeddedView(i,{},t.length),e=s.rootNodes,u&&e.length===1)f=e[0];else for(f=document.createElement('div'),o=0,h=e;o<h.length;o++)c=h[o],f.appendChild(c);return n&&n.appendChild(f),{viewRef:s,rootElement:f}},n.prototype.getPropChangeEvent=function(n){var t=this.typeData.changeEvents,i;if(t)for(i in t)if(t[i].indexOf(n)>-1)return i;return null},n.prototype._createEvents=function(){for(var t,u,f=this.resolvedTypeData.allImplEvents,n=0,i=f;n<i.length;n++)t=i[n],u=t==='initialized',this.directive[t]=new r.EventEmitter(u)},n.prototype.subscribeToEvents=function(n){var e=this.resolvedTypeData.changeEventMap,i,u,r,f,t;for(n=!!n,i=0,u=e;i<u.length;i++)t=u[i],n!==t.event.indexOf(".")<0&&this.addHandlers(t);if(n)for(r=0,f=e;r<f.length;r++)t=f[r],this.triggerPropChangeEvents(t,!0)},n.prototype.addHandlers=function(t){var i=this,r=this.directive;n.evaluatePath(r,t.event).addHandler(function(n,u){i._runInsideNgZone(function(){i.isInitialized&&i.triggerPropChangeEvents(t);t.eventImpl&&i._triggerEvent(r[t.eventImpl],u,t.props&&t.props.length>0)})})},n.prototype.triggerPropChangeEvents=function(n,t){var r,i,u,f;if(t===void 0&&(t=!0),r=this.directive,n.props&&n.props.length)for(i=0,u=n.props;i<u.length;i++)f=u[i],this._triggerEvent(r[f.evImpl],r[f.prop],t)},n.prototype._setupAsChild=function(){this._isChild()&&(this._isHostElement()&&(this.elementRef.nativeElement.style.display='none'),this.parentBehavior=n.getBehavior(this.injectedParent))},n.prototype._isAsyncBinding=function(){var t=this.directive[n.asyncBindingUpdatePropAttr];return t==null?e.asyncBindings:t},n.prototype._isChild=function(){return this._isParentInitializer()||this._isParentReferencer()},n.prototype._isParentInitializer=function(){return this.directive[n.parPropAttr]!=null},n.prototype._isParentReferencer=function(){return!!this.typeData.parentRefProperty},n.prototype._getParentProp=function(){return this.directive[n.parPropAttr]},n.prototype._getParentReferenceProperty=function(){return this.typeData.parentRefProperty},n.prototype._useParentObj=function(){return!1},n.prototype._parentInCtor=function(){return this._isParentReferencer()&&this._getParentReferenceProperty()==''},n.prototype._initParent=function(){var o,n,f,t;if(this.parentBehavior&&!this._useParentObj()){var r=this.parentBehavior.directive,e=this._getParentProp(),u=this.directive;this._isParentInitializer()&&(o=this._getParentProp(),n=r[e],i.isArray(n)?(f=this._isHostElement(),t=f?this._getSiblingIndex():-1,(t<0||t>=n.length)&&(t=n.length),n.splice(t,0,u),f&&(this._siblingInsertedEH=this._siblingInserted.bind(this),this.elementRef.nativeElement.addEventListener('DOMNodeInserted',this._siblingInsertedEH))):r[e]=u);this._isParentReferencer()&&!this._parentInCtor()&&(u[this._getParentReferenceProperty()]=r)}},n.prototype._getSiblingIndex=function(){var r=this.elementRef.nativeElement,u=r.parentElement,t,i;if(!u)return-1;var f=u.childNodes,e=-1,o=this.typeData.siblingId;for(t=0;t<f.length;t++)if(i=f[t],i.nodeType==1&&i.getAttribute(n.siblingDirIdAttr)==o&&(++e,i===r))return e;return-1},n.prototype._siblingInserted=function(n){if(n.target===this.elementRef.nativeElement){var t=this._getSiblingIndex(),i=this.parentBehavior.directive[this._getParentProp()],u=this.directive,r=i.indexOf(u);t>=0&&r>=0&&t!==r&&(i.splice(r,1),t=Math.min(t,i.length),i.splice(t,0,u))}},n.prototype._isHostElement=function(){return this.elementRef.nativeElement.nodeType===Node.ELEMENT_NODE},n.prototype._runInsideNgZone=function(t){var i=n;return i.ngZone&&!i._ngZoneRun&&(i._ngZoneRun=i.ngZone.run.bind(i.ngZone)),(i._ngZoneRun||function(n){return n()})(t)},n.prototype._triggerEvent=function(n,t,i){var f=this,r,u;i&&this._isAsyncBinding()?(r=this._pendingEvents,u={event:n,args:t},r.push(u),this._pendingEventsTO==null&&(this._pendingEventsTO=setTimeout(function(){f._triggerPendingEvents(!1)},0))):n.emit(t)},n.prototype._triggerPendingEvents=function(n){var u,t,i,r;for(this._pendingEventsTO!=null&&(clearTimeout(this._pendingEventsTO),this._pendingEventsTO=null),u=[].concat(this._pendingEvents),this._pendingEvents.splice(0,this._pendingEvents.length),t=0,i=u;t<i.length;t++)r=i[t],r.event.emit(r.args);n&&this._pendingEvents.length&&this._triggerPendingEvents(!0)},n.prototype.flushPendingEvents=function(){this._triggerPendingEvents(!0)},n.evaluatePath=function(n,t){return this._pathBinding.path=t,this._pathBinding.getValue(n)},n.getBehavior=function(t){return t?t[n.BehaviourRefProp]:null},n}();u.directiveTypeDataProp='meta';u.directiveResolvedTypeDataProp='_wjResolvedMeta';u.BehaviourRefProp='_wjBehaviour';u.parPropAttr='wjProperty';u.wjModelPropAttr='wjModelProperty';u.initializedEventAttr='initialized';u.isInitializedPropAttr='isInitialized';u.siblingDirIdAttr='wj-directive-id';u.asyncBindingUpdatePropAttr='asyncBindings';u.siblingDirId=0;u.wijmoComponentProviderId='WjComponent';u.outsideZoneEvents={pointermove:!0,pointerover:!0,mousemove:!0,wheel:!0,touchmove:!0};u._pathBinding=new i.Binding('');t.WjDirectiveBehavior=u;f=function(){function n(){}return n.initEvents=function(n,t){for(var i,r,u,o,s,f=[],e=0,h=t;e<h.length;e++)if(i=h[e],r=i.props,i.event&&i.eventImpl&&f.push(i.eventImpl+':'+i.event),r&&r.length)for(u=0,o=r;u<o.length;u++)s=o[u],f.push(s.evImpl+':'+s.evExposed);return f},n.getChangeEventNameImplemented=function(t){return n.getChangeEventNameExposed(t)+n.changeEventImplementSuffix},n.getChangeEventNameExposed=function(n){return n+'Change'},n.getWjEventNameImplemented=function(t){return t+n.wjEventImplementSuffix},n.getWjEventName=function(t){if(t){var r=n.wjEventImplementSuffix,i=t.length-r.length;if(i>0&&t.substr(i)===r)return t.substr(0,i)}return null},n.getBaseType=function(n){var t;return n&&(t=Object.getPrototypeOf(n.prototype))&&t.constructor},n.getAnnotations=function(n){return Reflect.getMetadata('annotations',n)},n.getAnnotation=function(n,t){var i,r,u;if(t&&n)for(i=0,r=n;i<r.length;i++)if(u=r[i],u instanceof t)return u;return null},n.getTypeAnnotation=function(t,i,r){for(var f,u=t;u;u=r?null:n.getBaseType(u))if(f=n.getAnnotation(n.getAnnotations(u),i),f)return f;return null},n.equals=function(n,t){return n!=n&&t!=t||i.DateTime.equals(n,t)||n===t},n._copy=function(n,t,r,u,f){var e,o,s;if(n&&t)for(e in t)(u||e[0]!=='_')&&(o=t[e],(!f||f(e,o))&&(s=n[e],i.isArray(o)?n[e]=(!i.isArray(s)||r?[]:s).concat(o):o!==undefined&&(n[e]=o)))},n}();f.changeEventImplementSuffix='PC';f.wjEventImplementSuffix='Ng';t.Ng2Utils=f;h=function(){function n(n){this._isFirstChange=!0;this._isSubscribed=!1;this._onChange=function(){};this._onTouched=function(){};this._directive=n;this._behavior=u.getBehavior(n)}return n.prototype.writeValue=function(n){var t=this,i;this._modelValue=n;this._directive.isInitialized?(this._ensureInitEhUnsubscribed(),this._updateDirective(),this._isFirstChange=!1):this._dirInitEh?this._isFirstChange=!1:(i=this._directive.initialized,this._dirInitEh=i.subscribe(function(){t._updateDirective();t._ensureInitEhUnsubscribed()}))},n.prototype.registerOnChange=function(n){this._onChange=n},n.prototype.registerOnTouched=function(n){this._onTouched=n},n.prototype._updateDirective=function(){if(!this._isFirstChange||this._modelValue!=null){if(this._ensureNgModelProp(),this._directive&&this._ngModelProp){var n=this._modelValue;n===''&&(n=null);this._directive[this._ngModelProp]=n}this._ensureSubscribed()}},n.prototype._ensureSubscribed=function(){var n,t,r;this._isSubscribed||(n=this._directive,n&&(this._ensureNgModelProp(),t=this._ngModelProp=n[u.wjModelPropAttr],t&&(r=this._behavior.getPropChangeEvent(t),r&&n[r].addHandler(this._dirValChgEh,this)),n instanceof i.Control&&n.lostFocus.addHandler(this._dirLostFocusEh,this),this._isSubscribed=!0))},n.prototype._ensureNgModelProp=function(){!this._ngModelProp&&this._directive&&(this._ngModelProp=this._directive[u.wjModelPropAttr])},n.prototype._ensureInitEhUnsubscribed=function(){this._dirInitEh&&(this._dirInitEh.unsubscribe(),this._dirInitEh=null)},n.prototype._dirValChgEh=function(){if(this._onChange&&this._directive&&this._ngModelProp){var n=this._directive[this._ngModelProp];f.equals(this._modelValue,n)||(this._modelValue=n,this._onChange(n))}},n.prototype._dirLostFocusEh=function(){this._onTouched&&this._onTouched()},n}();t.WjValueAccessor=h;t.WjValueAccessorFactory=c;l=[];o=function(){function n(){}return n}();o.decorators=[{type:r.NgModule,args:[{},]},];o.ctorParameters=function(){return[]};t.WjDirectiveBaseModule=o})