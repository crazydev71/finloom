/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
System.register(["wijmo/wijmo.pdf","wijmo/wijmo.grid","wijmo/wijmo","wijmo/wijmo.grid.pdf"],function(n,t){"use strict";function y(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.multirow}function p(){var n,t;return(n=window.wijmo)&&(t=n.grid)&&t.sheet}function d(){var n;return(n=window.wijmo)&&n.olap}function e(n,t,i){var u,f,o;if(i===void 0&&(i=!1),t&&n)for(u in t)if(f=t[u],o=n[u],r.isObject(f)){if(o===undefined||!r.isObject(o)&&i)if(r.isFunction(f.clone)){n[u]=o=f.clone();continue}else n[u]=o={};r.isObject(o)&&e(n[u],f,i)}else(o===undefined||i&&f!==undefined)&&(n[u]=f);return n}var c=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),et=t&&t.id,u,i,r,g,f,a,w,o,l,v,nt,tt,it,b,h,rt,ut,k,s,ft;return{setters:[function(n){u=n},function(n){i=n},function(n){r=n},function(n){g=n}],execute:function(){window.wijmo=window.wijmo||{};window.wijmo.grid=window.wijmo.grid||{};window.wijmo.grid.pdf=g,function(n){n[n.ActualSize=0]="ActualSize";n[n.PageWidth=1]="PageWidth";n[n.SinglePage=2]="SinglePage"}(f||(f={}));n("ScaleMode",f),function(n){n[n.All=0]="All";n[n.Selection=1]="Selection"}(a||(a={}));n("ExportMode",a);w=function(n){function t(t,i,u,f,e,o,s,h,c){var l=n.call(this,t,i)||this;return l.cancelBorders=!1,l._cell=r.asType(u,HTMLElement,!0),l._canvas=f,l._clientRect=e,l._contentRect=o,l._textTop=s,l._style=h,l._getFormattedCell=c,l}return c(t,n),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clientRect",{get:function(){return this._clientRect},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return r.asFunction(this._getFormattedCell)()},Object.defineProperty(t.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textTop",{get:function(){return this._textTop},enumerable:!0,configurable:!0}),t}(i.CellRangeEventArgs);n("PdfFormatItemEventArgs",w);l=function(){function n(){}return n.draw=function(n,t,i,o,s){r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The doc argument cannot be null.');var h=e({},s);e(h,this.DefaultDrawSettings);h.scaleMode=i==null?f.ActualSize:o==null?f.PageWidth:f.SinglePage;try{h.recalculateStarWidths&&n.columns._updateStarSizes(u.ptToPx(t.width));this._draw(n,t,null,i,o,h)}finally{h.recalculateStarWidths&&n.invalidate(!0)}},n.drawToPosition=function(n,t,i,o,s,h){r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The doc argument cannot be null.');r.assert(!!i,'The point argument cannot be null.');var c=e({},h);e(c,this.DefaultDrawSettings);c.scaleMode=o==null?f.ActualSize:s==null?f.PageWidth:f.SinglePage;try{c.recalculateStarWidths&&n.columns._updateStarSizes(u.ptToPx(t.width));this._draw(n,t,i,o,s,c)}finally{c.recalculateStarWidths&&n.invalidate(!0)}},n.export=function(n,t,i){var o,f;r.assert(!!n,'The flex argument cannot be null.');r.assert(!!t,'The fileName argument cannot be empty.');i=e({},i);e(i,this.DefaultExportSettings);o=i.documentOptions.ended;i.documentOptions.ended=function(n,i){o&&o.apply(f,[n,i])===!1||u.saveBlob(i.blob,t)};f=new u.PdfDocument(i.documentOptions);try{i.recalculateStarWidths&&n.columns._updateStarSizes(u.ptToPx(f.width));this._draw(n,f,null,null,null,i);f.end()}finally{i.recalculateStarWidths&&n.invalidate(!0)}},n._draw=function(n,t,u,f,e,h){var nt=u!=null,l=new r.Size(t.width,t.height),c,k;u||(u=new r.Point(0,t.y));r.isArray(h.embeddedFonts)&&h.embeddedFonts.forEach(function(n){t.registerFont(n)});var d=s.getSelection(n,h.exportMode),g=this._getGridRenderer(n,d,!1,this.BorderWidth,null,!0),a=new r.Rect(u.x||0,u.y||0,f||l.width,e||l.height),v=this._getScaleFactor(g,h.scaleMode,a),y=this._getPages(g,d,a,h,nt,v);o=document.createElement('div');o.setAttribute(i.FlexGrid._WJS_MEASURE,'true');o.style.visibility='hidden';n.hostElement.appendChild(o);try{for(c=0;c<y.length;c++){c>0&&t.addPage();var p=y[c],w=p.pageCol===0?a.left:0,b=p.pageRow===0?a.top:0;t.saveState();t.paths.rect(0,0,l.width,l.height).clip();t.scale(v,v,new r.Point(w,b));t.translate(w,b);k=this._getGridRenderer(n,p.range,h.repeatMergedValuesAcrossPages,this.BorderWidth,h.styles,c===y.length-1);k.render(t,h);t.restoreState();t.x=w;t.y=b+k.renderSize.height*v}}finally{o&&(o.parentElement.removeChild(o),o=null)}},n._getScaleFactor=function(n,t,i){var u=1,e,r;return t===f.ActualSize?u:(e=n.renderSize,t===f.SinglePage?(r=Math.min(i.width/e.width,i.height/e.height),r<1&&(u=r)):(r=i.width/e.width,r<1&&(u=r)),u)},n._getPages=function(n,t,i,r,e,o){var ht=this,h=[],c=[],p=u.pxToPt,w=n.flex,nt=n.showColumnHeader,tt=n.showRowHeader,k=nt?p(w.columnHeaders.height):0,d=tt?p(w.rowHeaders.width):0,yt=r.scaleMode===f.ActualSize||r.scaleMode===f.PageWidth,pt=r.scaleMode===f.ActualSize,wt=(i.width-i.left)*(1/o),bt=(i.height-i.top)*(1/o),kt=i.width*(1/o),dt=i.height*(1/o),a=k,v=d,ct=e&&r.scaleMode==f.ActualSize,it,y,rt,ut,g,et,s,l,st,vt;if(yt&&(it=0,t.forEach(w.cells,function(n,t,i,r){var f=h.length?dt:bt,u;b.isRenderableRow(n)&&(u=p(n.renderHeight),it++,a+=u,(nt||it>1)&&(a-=ht.BorderWidth),a>f&&(k+u>f||ct?(h.push(r),a=k):(h.push(r-1),a=k+u),nt&&(a-=ht.BorderWidth)))})),y=t.length()-1,y<0&&(y=0),h.length&&h[h.length-1]===y||h.push(y),pt)for(rt=0,s=t.leftCol;s<=t.rightCol;s++)ut=w.columns[s],ut.isVisible&&(g=p(ut.renderWidth),et=c.length?kt:wt,rt++,v+=g,(tt||rt>1)&&(v-=this.BorderWidth),v>et&&(d+g>et||ct?(c.push(s),v=d):(c.push(s-1),v=d+g),tt&&(v-=this.BorderWidth)));c.length&&c[c.length-1]===t.rightCol||c.push(t.rightCol);var lt=[],ot=!1,at=1,gt=e&&r.maxPages>0?1:r.maxPages;for(s=0;s<h.length&&!ot;s++)for(l=0;l<c.length&&!ot;l++,at++)(ot=at>gt)||(st=s==0?0:h[s-1]+1,vt=l==0?t.leftCol:c[l-1]+1,lt.push(new ft(t.subrange(st,h[s]-st+1,vt,c[l]),l,s)));return lt},n._getGridRenderer=function(n,t,i,r,u,f){var e=y()&&n instanceof y().MultiRow&&tt||p()&&n instanceof p().FlexSheet&&nt||d()&&n instanceof d().PivotGrid&&it||v;return new e(n,t,i,r,u,f)},n}();l.BorderWidth=1;l.DefaultDrawSettings={maxPages:Number.MAX_VALUE,exportMode:a.All,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:new u.PdfFont,padding:1.5,verticalAlign:'middle'},headerCellStyle:{font:{weight:'bold'}},errorCellStyle:{backgroundColor:'rgba(255, 0, 0, 0.3)'}}};l.DefaultExportSettings=e({scaleMode:f.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}}},l.DefaultDrawSettings);n("FlexGridPdfConverter",l);v=function(){function n(n,t,r,u,f,e){this._flex=n;this._borderWidth=u;this._lastPage=e;this._topLeft=new h(this,n.topLeftCells,this.showRowHeader&&this.showColumnHeader?new s(n,[new i.CellRange(0,0,n.topLeftCells.rows.length-1,n.topLeftCells.columns.length-1)]):new s(n,[]),r,u,f);this._rowHeader=new h(this,n.rowHeaders,this.showRowHeader?t.clone(0,n.rowHeaders.columns.length-1):new s(n,[]),r,u,f);this._columnHeader=new h(this,n.columnHeaders,this.showColumnHeader?new s(n,[new i.CellRange(0,t.leftCol,n.columnHeaders.rows.length-1,t.rightCol)]):new s(n,[]),r,u,f);this._cells=new h(this,n.cells,t,r,u,f);this._bottomLeft=new h(this,n.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new s(n,[new i.CellRange(0,0,n.bottomLeftCells.rows.length-1,n.bottomLeftCells.columns.length-1)]):new s(n,[]),r,u,f);this._columnFooter=new h(this,n.columnFooters,this.showColumnFooter?new s(n,[new i.CellRange(0,t.leftCol,n.columnFooters.rows.length-1,t.rightCol)]):new s(n,[]),r,u,f)}return n.prototype.render=function(n,t){var r=Math.max(0,Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)-this._borderWidth),i=Math.max(0,Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)-this._borderWidth);this._topLeft.render(n,0,0,t);this._rowHeader.render(n,0,i,t);this._columnHeader.render(n,r,0,t);this._cells.render(n,r,i,t);i=Math.max(0,i+this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(n,0,i,t);this._columnFooter.render(n,r,i,t)},Object.defineProperty(n.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"renderSize",{get:function(){var n=Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)+Math.max(this._rowHeader.renderSize.height,this._cells.renderSize.height)+Math.max(this._bottomLeft.renderSize.height,this._columnFooter.renderSize.height),t=Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)+Math.max(this._columnHeader.renderSize.width,this._cells.renderSize.width);return this._columnHeader.visibleRows>0&&(n-=this._borderWidth),this._columnFooter.visibleRows>0&&(n-=this._borderWidth),this._rowHeader.visibleColumns>0&&(t-=this._borderWidth),new r.Size(t,n)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&i.HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&i.HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),n.prototype.alignMergedTextToTheTopRow=function(){return!1},n.prototype.getCellValue=function(n,t,i){return n.getCellData(i,t,!0)},n.prototype.getColumn=function(n,t){return n.columns[t]},n.prototype.isAlternatingRow=function(n){return n.index%2!=0},n.prototype.isMergeableCell=function(){return!0},n}();nt=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return c(t,n),t.prototype.getCellValue=function(t,r,u){return t.cellType===i.CellType.Cell?t.rows[u]instanceof p().HeaderRow?this.flex.columnHeaders.getCellData(u,r,!0):this.flex.getCellValue(u,r,!0):n.prototype.getCellValue.call(this,t,r,u)},Object.defineProperty(t.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),t}(v);tt=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return c(t,n),t.prototype.getColumn=function(n,t,i){return this.flex.getBindingColumn(n,i,t)},t.prototype.isAlternatingRow=function(t){return t instanceof y()._MultiRow?t.dataIndex%2!=0:n.prototype.isAlternatingRow.call(this,t)},t.prototype.isMergeableCell=function(){return!0},t}(v);it=function(n){function t(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return c(t,n),t.prototype.alignMergedTextToTheTopRow=function(n){return!this.flex.centerHeadersVertically&&(n.cellType===i.CellType.ColumnHeader||n.cellType===i.CellType.RowHeader)},t}(v);b=function(){function n(n,t){this._panel=n;this._range=t.clone()}return n.isRenderableRow=function(n){return n.isVisible&&!(n instanceof i._NewRowTemplate)},Object.defineProperty(n.prototype,"visibleRows",{get:function(){var n=this;return this._visibleRows==null&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){n.isRenderableRow(t)&&n._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"visibleColumns",{get:function(){if(this._visibleColumns==null&&(this._visibleColumns=0,this._range.isValid))for(var n=this._range.leftCol;n<=this._range.rightCol;n++)this._panel.columns[n].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){if(this._size==null){var n=this._range.getRenderSize(this._panel);this._size=new r.Size(u.pxToPt(n.width),u.pxToPt(n.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),n.prototype.isRenderableRow=function(t){return n.isRenderableRow(t)},n}();h=function(n){function t(t,i,r,u,f,e){var o=n.call(this,i,r)||this;return o._gr=t,o._repeatMergedValues=u,o._borderWidth=f,o._styles=e,o}return c(t,n),Object.defineProperty(t.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._styles},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderSize",{get:function(){return this._renderSize==null&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),t.prototype.getRangeWidth=function(n,t){for(var e,i=0,r=0,o=this.panel,f=n;f<=t;f++)e=o.columns[f],e.isVisible&&(r++,i+=e.renderWidth);return i=u.pxToPt(i),r>1&&(i-=this._borderWidth*(r-1)),i},t.prototype.getRangeHeight=function(n,t){for(var e,i=0,r=0,o=this.panel,f=n;f<=t;f++)e=o.rows[f],this.isRenderableRow(e)&&(r++,i+=e.renderHeight);return i=u.pxToPt(i),r>1&&(i=i-this._borderWidth*(r-1)),i},t.prototype.render=function(n,t,i,u){var f=this,e=this.range,s=this.panel,l=new ut(this._gr.flex),c=new k(s,0,0,0,0),a=new rt(this,n,u,this._borderWidth),o,h;if(e.isValid){for(o={},h=e.leftCol;h<=e.rightCol;h++)o[h]=i;e.forEach(s,function(n,i,u){var nt,h,w,v,g;if(f.isRenderableRow(n))for(nt=t,h=e.leftCol;h<=e.rightCol;h++){var tt=f.gr.getColumn(s,h,u),y=undefined,p=undefined,b,k=!1,d=undefined;if(tt.isVisible){if(w=f._getCellValue(h,u),v=null,f.gr.isMergeableCell(tt,n)&&(v=l.getMergedRange(s,u,h)))if(c.copyFrom(v),v.topRow!==v.bottomRow)v.firstVisibleRow===u||u===i.topRow?(k=!0,b=f._repeatMergedValues?w:v.firstVisibleRow===u?w:'',y=f.getRangeHeight(u,Math.min(v.bottomRow,i.bottomRow)),p=f.getRangeWidth(h,h)):p=f.getRangeWidth(h,h);else for(k=!0,b=f._repeatMergedValues?w:h===v.leftCol?w:'',y=f.getRangeHeight(u,u),p=f.getRangeWidth(Math.max(e.leftCol,v.leftCol),Math.min(e.rightCol,v.rightCol)),d=Math.min(e.rightCol,v.rightCol),g=h+1;g<=d;g++)o[g]+=y-f._borderWidth;else c.setRange(u,h,u,h),k=!0,b=w,y=f.getRangeHeight(u,u),p=f.getRangeWidth(h,h);k&&a.renderCell(b,n,tt,c,new r.Rect(nt,o[h],p,y));y&&(o[h]+=y-f._borderWidth);p&&(nt+=p-f._borderWidth);d&&(h=d)}}})}},t.prototype._getCellValue=function(n,t){var u=this.panel,o=this.gr.getCellValue(u,n,t),r,f,e;return o||u.cellType!==i.CellType.Cell||(r=u.rows[t],r instanceof i.GroupRow&&r.dataItem&&r.dataItem.groupDescription&&n===u.columns.firstVisibleIndex&&(f=r.dataItem.groupDescription.propertyName,e=u.columns.getColumn(f),e&&e.header&&(f=e.header),o=f+': '+r.dataItem.name+' ('+r.dataItem.items.length+' items)')),o},t}(b);rt=function(){function n(n,t,i,r){this._pr=n;this._area=t;this._settings=i||{};this._borderWidth=r}return n.prototype.renderCell=function(n,t,f,e,s){var a,p=t.grid,v=this._pr.panel,g=function(){var n=e.topRow,t=e.leftCol,i=v.getCellElement(n,t);return i||(o.style.cssText='',o.className='',p.cellFactory.updateCell(v,n,t,o)),i||o},nt=function(n){return n.className=n.className.replace('wj-state-selected',''),n.className=n.className.replace('wj-state-multi-selected',''),window.getComputedStyle(n)},b=!!this._settings.customCellContent,y=null,h=this._getMergedCellStyle(t,f),c,l,k,d;if(b&&(y=g()),b&&(n=y.textContent.trim(),!n&&this._isBooleanCell(f,t,v)&&(n=this._extractCheckboxValue(y)+'')),b&&(c=nt(y),h.color=c.color,h.backgroundColor=c.backgroundColor,h.borderColor=c.borderColor||c.borderRightColor||c.borderBottomColor||c.borderLeftColor||c.borderTopColor,h.font=new u.PdfFont(c.fontFamily,u._asPt(c.fontSize,!0,undefined),c.fontStyle,c.fontWeight),h.textAlign=c.textAlign),h.boxSizing='border-box',h.borderWidth=this._borderWidth,h.borderStyle='solid',h.textAlign||t instanceof i.GroupRow&&!f.aggregate||(h.textAlign=f.getAlignment()),v.cellType===i.CellType.Cell&&p.rows.maxGroupLevel>=0&&e.leftCol===p.columns.firstVisibleIndex){var tt=t instanceof i.GroupRow?Math.max(t.level,0):p.rows.maxGroupLevel+1,it=u._asPt(h.paddingLeft||h.padding),rt=u.pxToPt(tt*p.treeIndent);h.paddingLeft=it+rt}l=this._measureCell(n,f,t,v,h,s);k=e.rowSpan>1&&e.visibleRowsCount>1&&this._pr.gr.alignMergedTextToTheTopRow(v);k&&(d=new r.Rect(l.contentRect.left,l.contentRect.top,l.contentRect.width,l.contentRect.height/(e.visibleRowsCount||1)),l.textRect=this._calculateTextRect(n,f,t,v,d,h));r.isFunction(this._settings.formatItem)&&(a=new w(v,e,y,this._area,l.rect,l.contentRect,l.textRect.top,h,function(){return y||g()}),a.data=n,this._settings.formatItem(a),a.data!==n&&(n=r.asString(a.data),l.textRect=this._calculateTextRect(n,f,t,v,k?d:l.contentRect,h)));this._renderCell(n,t,f,e,l,h,a?!a.cancel:!0,a?!a.cancelBorders:!0)},n.prototype._renderCell=function(n,t,i,r,u,f,e,o){if(e||o){var s=this._pr.panel,h=s.grid;this._isBooleanCellAndValue(n,i,t,s)?this._renderBooleanCell(n,u,f,e,o):this._renderTextCell(n,u,f,e,o)}},n.prototype._getMergedCellStyle=function(n,t){var r=this._pr.styles,u=e({},r.cellStyle),f=this._pr.panel,o=this._pr.gr.flex;switch(f.cellType){case i.CellType.Cell:this._isGroupRow(n)?e(u,r.groupCellStyle,!0):this._pr.gr.isAlternatingRow(n)&&e(u,r.altCellStyle,!0);break;case i.CellType.ColumnHeader:case i.CellType.RowHeader:case i.CellType.TopLeft:case i.CellType.BottomLeft:e(u,r.headerCellStyle,!0);break;case i.CellType.ColumnFooter:e(u,r.headerCellStyle,!0);e(u,r.footerCellStyle,!0)}return!this._settings.customCellContent&&o._getShowErrors()&&o._getError(f,n.index,t.index)&&e(u,r.errorCellStyle,!0),u},n.prototype._isBooleanCellAndValue=function(n,t,i,r){return this._isBooleanCell(t,i,r)&&this._isBoolean(n)},n.prototype._isBooleanCell=function(n,t,u){return n.dataType===r.DataType.Boolean&&u.cellType===i.CellType.Cell&&!this._isGroupRow(t)},n.prototype._isBoolean=function(n){var t=r.isString(n)&&n.toLowerCase();return t==='true'||t==='false'||n===!0||n===!1},n.prototype._isGroupRow=function(n){return n instanceof i.GroupRow&&n.hasChildren},n.prototype._measureCell=function(n,t,i,f,e,o){this._decompositeStyle(e);var y=o.left,p=o.top,h=o.height,c=o.width,v=this._parseBorder(e),w=v.left.width,b=v.top.width,nt=v.bottom.width,tt=v.right.width,s=this._parsePadding(e),l=0,a=0,k=0,d=0;if(e.boxSizing==='content-box'||e.boxSizing===undefined)l=s.top+h+s.bottom,a=s.left+c+s.right,k=h,d=c;else{if(e.boxSizing==='border-box')u._IE&&e instanceof CSSStyleDeclaration?(l=s.top+s.bottom+h,a=s.left+s.right+c):(l=h-b-nt,a=c-w-tt);else throw'Invalid value: '+e.boxSizing;k=l-s.top-s.bottom;d=a-s.left-s.right}var o=new r.Rect(y,p,c,h),it=new r.Rect(y+w,p+b,a,l),g=new r.Rect(y+w+s.left,p+b+s.top,d,k),rt=this._calculateTextRect(n,t,i,f,g,e);return{rect:o,clientRect:it,contentRect:g,textRect:rt}},n.prototype._decompositeStyle=function(n){if(n){var t;(t=n.borderColor)&&(n.borderLeftColor||(n.borderLeftColor=t),n.borderRightColor||(n.borderRightColor=t),n.borderTopColor||(n.borderTopColor=t),n.borderBottomColor||(n.borderBottomColor=t));(t=n.borderWidth)&&(n.borderLeftWidth||(n.borderLeftWidth=t),n.borderRightWidth||(n.borderRightWidth=t),n.borderTopWidth||(n.borderTopWidth=t),n.borderBottomWidth||(n.borderBottomWidth=t));(t=n.borderStyle)&&(n.borderLeftStyle||(n.borderLeftStyle=t),n.borderRightStyle||(n.borderRightStyle=t),n.borderTopStyle||(n.borderTopStyle=t),n.borderBottomStyle||(n.borderBottomStyle=t));(t=n.padding)&&(n.paddingLeft||(n.paddingLeft=t),n.paddingRight||(n.paddingRight=t),n.paddingTop||(n.paddingTop=t),n.paddingBottom||(n.paddingBottom=t))}},n.prototype._parseBorder=function(n){var t={left:{width:0},top:{width:0},bottom:{width:0},right:{width:0}};return n.borderLeftStyle!=='none'&&(t.left={width:u._asPt(n.borderLeftWidth),style:n.borderLeftStyle,color:n.borderLeftColor}),n.borderTopStyle!=='none'&&(t.top={width:u._asPt(n.borderTopWidth),style:n.borderTopStyle,color:n.borderTopColor}),n.borderBottomStyle!=='none'&&(t.bottom={width:u._asPt(n.borderBottomWidth),style:n.borderBottomStyle,color:n.borderBottomColor}),n.borderRightStyle!=='none'&&(t.right={width:u._asPt(n.borderRightWidth),style:n.borderRightStyle,color:n.borderRightColor}),t},n.prototype._parsePadding=function(n){return{left:u._asPt(n.paddingLeft),top:u._asPt(n.paddingTop),bottom:u._asPt(n.paddingBottom),right:u._asPt(n.paddingRight)}},n.prototype._renderEmptyCell=function(n,t,i,r){var e=n.rect.left,o=n.rect.top,h=n.clientRect.width,c=n.clientRect.height,d=n.rect.height,g=n.rect.width,f=n.clientRect.left-n.rect.left,s=n.clientRect.top-n.rect.top,l=n.rect.top+n.rect.height-(n.clientRect.top+n.clientRect.height),a=n.rect.left+n.rect.width-(n.clientRect.left+n.clientRect.width),y,p;if(r&&(f||a||l||s)){var v=t.borderLeftColor||t.borderColor,w=t.borderRightColor||t.borderColor,b=t.borderTopColor||t.borderColor,k=t.borderBottomColor||t.borderColor;f&&s&&l&&a&&f===a&&f===l&&f===s&&v===w&&v===k&&v===b?(y=f,p=y/2,this._area.paths.rect(e+p,o+p,h+y,c+y).stroke(new u.PdfPen(v,y))):(f&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f,o+s+c],[e,o+s+c+l]]).fill(v),s&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f+h,o+s],[e+f+h+a,o]]).fill(b),a&&this._area.paths.polygon([[e+f+h+a,o],[e+f+h,o+s],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(w),l&&this._area.paths.polygon([[e,o+s+c+l],[e+f,o+s+c],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(k))}i&&t.backgroundColor&&h>0&&c>0&&this._area.paths.rect(e+f,o+s,h,c).fill(t.backgroundColor)},n.prototype._renderBooleanCell=function(n,t,i,f,e){if(this._renderEmptyCell(t,i,f,e),f){var c=.5,a=t.textRect.left,v=t.textRect.top,o=t.textRect.height;if(this._area.paths.rect(a,v,o,o).fillAndStroke(r.Color.fromRgba(255,255,255),new u.PdfPen(undefined,c)),r.changeType(n,r.DataType.Boolean,'')===!0){var l=o/20,s=o-c-l*2,h=o/8;this._area._pdfdoc.saveState();this._area.translate(a+c/2+l,v+c/2+l).paths.moveTo(h/2,s*.6).lineTo(s-s*.6,s-h).lineTo(s-h/2,h/2).stroke(new u.PdfPen(undefined,h));this._area._pdfdoc.restoreState()}}},n.prototype._renderTextCell=function(n,t,i,r,f){(this._renderEmptyCell(t,i,r,f),r)&&n&&this._area.drawText(n,t.textRect.left,t.textRect.top,{brush:i.color,font:i.font,height:t.textRect.height,width:t.textRect.width,align:i.textAlign==='center'?u.PdfTextHorizontalAlign.Center:i.textAlign==='right'?u.PdfTextHorizontalAlign.Right:i.textAlign==='justify'?u.PdfTextHorizontalAlign.Justify:u.PdfTextHorizontalAlign.Left})},n.prototype._calculateTextRect=function(n,t,i,r,u,f){var e=u.clone(),s,o;if(this._isBooleanCellAndValue(n,t,i,r)){s=this._area.measureText('A',f.font,{width:Infinity}).size.height;switch(f.verticalAlign){case'middle':e.top=u.top+u.height/2-s/2;break;case'bottom':e.top=u.top+u.height-s}switch(f.textAlign){case'justify':case'center':e.left=u.left+u.width/2-s/2;break;case'right':e.left=u.left+u.width-s}e.height=e.width=s}else if(e.height>0&&e.width>0)switch(f.verticalAlign){case'bottom':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height-o.size.height,e.height=o.size.height);break;case'middle':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height/2-o.size.height/2,e.height=o.size.height)}return e},n.prototype._extractCheckboxValue=function(n){var t=n.querySelector('input.wj-cell-check[type=checkbox]'),i;return t&&(i=window.getComputedStyle(t),i.display!=='none'&&i.visibility!=='hidden')?t.checked:undefined},n}();ut=function(){function n(n){this._columns={};this._flex=n}return n.prototype.getMergedRange=function(n,t,i){var r=this._columns[i],u;return r&&t>=r.topRow&&t<=r.bottomRow?r:(u=this._flex.getMergedRange(n,t,i,!1),this._columns[i]=u?new k(n,u):null)},n}();k=function(n){function t(t,r,u,f,e){var o=this,s;o=r instanceof i.CellRange?n.call(this,r.row,r.col,r.row2,r.col2)||this:n.call(this,r,u,f,e)||this;o.firstVisibleRow=-1;o.visibleRowsCount=0;var c=o.topRow,l=o.bottomRow,h=t.rows.length;if(h>0)for(s=c;s<=l&&s<h;s++)t.rows[s].isVisible&&(o.firstVisibleRow<0&&(o.firstVisibleRow=s),o.visibleRowsCount++);return o}return c(t,n),t.prototype.copyFrom=function(n){this.setRange(n.row,n.col,n.row2,n.col2);this.firstVisibleRow=n.firstVisibleRow;this.visibleRowsCount=n.visibleRowsCount},t}(i.CellRange);s=function(){function n(n,t){this._flex=n;this._ranges=t||[]}return n.getSelection=function(t,r){var f=[],o,e,u,s;if(r===a.All)f.push(new i.CellRange(0,0,t.rows.length-1,t.columns.length-1));else{o=t.selection;switch(t.selectionMode){case i.SelectionMode.Cell:case i.SelectionMode.CellRange:f.push(o);break;case i.SelectionMode.Row:f.push(new i.CellRange(o.topRow,0,o.topRow,t.cells.columns.length-1));break;case i.SelectionMode.RowRange:f.push(new i.CellRange(o.topRow,0,o.bottomRow,t.cells.columns.length-1));break;case i.SelectionMode.ListBox:for(e=-1,u=0;u<t.rows.length;u++)s=t.rows[u],s.isSelected?(e<0&&(e=u),u===t.rows.length-1&&f.push(new i.CellRange(e,0,u,t.cells.columns.length-1))):(e>=0&&f.push(new i.CellRange(e,0,u-1,t.cells.columns.length-1)),e=-1)}}return new n(t,f)},n.prototype.length=function(){for(var n,i=0,t=0;t<this._ranges.length;t++)n=this._ranges[t],n.isValid&&(i+=n.bottomRow-n.topRow+1);return i},Object.defineProperty(n.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),n.prototype.clone=function(t,i){for(var r,f=[],u=0;u<this._ranges.length;u++)r=this._ranges[u].clone(),arguments.length>0&&(r.col=t),arguments.length>1&&(r.col2=i),f.push(r);return new n(this._flex,f)},n.prototype.getRenderSize=function(n){for(var u,t=new r.Size(0,0),i=0;i<this._ranges.length;i++)u=this._ranges[i].getRenderSize(n),t.width=Math.max(t.width,u.width),t.height+=u.height;return t},n.prototype.forEach=function(n,t){for(var i,r,f=0,u=0;u<this._ranges.length;u++)if(i=this._ranges[u],i.isValid)for(r=i.topRow;r<=i.bottomRow;r++)t(n.rows[r],i,r,f++)},n.prototype.subrange=function(t,r,u,f){var l=[],o,s,h,e;if(t>=0&&r>0)for(o=0,s=0,h=0;h<this._ranges.length&&r>0;h++,o=s+1)if(e=this._ranges[h],s=o+(e.bottomRow-e.topRow),!(t>s)){var c=t>o?e.topRow+(t-o):e.topRow,a=Math.min(e.bottomRow,c+r-1),v=arguments.length>2?u:e.leftCol,y=arguments.length>2?f:e.rightCol;l.push(new i.CellRange(c,v,a,y));r-=a-c+1}return new n(this._flex,l)},n}();ft=function(){function n(n,t,i){this._col=t;this._row=i;this._range=n}return Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),n}()}}})